‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏±‡∏ö knat ‚Äî ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ **README.md ‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏™‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå **data_loader.py** ‡πÅ‡∏•‡∏∞ **main_loader.py** (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô robust ‡∏û‡∏£‡πâ‡∏≠‡∏° fastparquet-only)

---

# üìò **README.md ‚Äî Robust Data Loader Utility (fastparquet edition)**

## üìå **‡∏™‡∏£‡∏∏‡∏õ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå**

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:

* üîç **‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å**
* üßπ **‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô DataFrame ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (pandas)**
* üì¶ **‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô Parquet (fastparquet engine ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)**
* ‚öôÔ∏è **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏≤‡∏¢‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï ‡πÄ‡∏ä‡πà‡∏ô .xls/.xlsx/.csv/.htm/.html**
* üß∞ **‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏ä‡πà‡∏ô‡πÅ‡∏¢‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏°.3) ‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å PDF ‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•**

‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 2 ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å:

| ‡πÑ‡∏ü‡∏•‡πå             | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà                                                                        |
| ---------------- | ------------------------------------------------------------------------------ |
| `data_loader.py` | ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏£‡∏ß‡∏°, ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° parse ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö, ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• + ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢ |
| `main_loader.py` | UI ‡πÅ‡∏ö‡∏ö CLI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Parquet ‡πÅ‡∏•‡πâ‡∏ß export PDF            |

---

# üìÅ **‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥**

```
project/
‚îÇ
‚îú‚îÄ‚îÄ data_loader.py
‚îú‚îÄ‚îÄ main_loader.py
‚îú‚îÄ‚îÄ cn_var.py             ‚Üê ‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô getData2Frame(), getCNPDF() ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
‚îú‚îÄ‚îÄ data/                 ‚Üê ‡πÉ‡∏™‡πà‡πÑ‡∏ü‡∏•‡πå .xls / .xlsx / .csv ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
‚îÇ     ‚îú‚îÄ‚îÄ file1.xls
‚îÇ     ‚îú‚îÄ‚îÄ file2.htm
‚îÇ     ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ README.md
```

---

# üöÄ **‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å**

### ‚úî Robust file loading

‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:

* `.xls` (HTML disguised ‡∏´‡∏£‡∏∑‡∏≠ Excel ‡∏à‡∏£‡∏¥‡∏á)
* `.xlsx`
* `.csv`
* `.htm / .html`

‡πÉ‡∏ä‡πâ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

1. `read_html`
2. `read_excel` (‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢ header row ‡πÄ‡∏ä‡πà‡∏ô `[0,1,None]`)
3. `read_csv` (‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô csv)

### ‚úî ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ

`DataLoader.load_all()` ‡∏Ñ‡∏∑‡∏ô:

```python
combined_df, failed_files
```

‡πÇ‡∏î‡∏¢ `failed_files` ‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:

```python
[
  {"path": "data/broken.xls", "error": "read_excel_failed"},
  ...
]
```

### ‚úî ‡πÉ‡∏ä‡πâ fastparquet 100%

* ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå Parquet ‡∏î‡πâ‡∏ß‡∏¢ `engine="fastparquet"`
* ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏ß‡∏¢ fastparquet ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
* ‡πÑ‡∏°‡πà auto-detect engine ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î

### ‚úî ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö threading (option)

‡πÄ‡∏£‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å

### ‚úî ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö tqdm progress bar (option)

---

# üîß **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies**

## üü¶ Windows / üü© Linux / üü™ macOS

### 1) ‡∏™‡∏£‡πâ‡∏≤‡∏á Virtual Environment (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

```bash
python -m venv venv
source venv/bin/activate        # Mac/Linux
venv\Scripts\activate           # Windows
```

### 2) ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ

```bash
pip install pandas fastparquet
```

### (Optional) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö progress bar

```bash
pip install tqdm
```

---

# ‚ñ∂Ô∏è **‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô**

## 1) **‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `data/`**

```bash
python main_loader.py --create --data-dir data
```

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞:

* ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô `data/`
* ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ `getData2Frame()`
* ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:

  * `all68_m3.parquet`
  * `68_m3.parquet`

---

## 2) **‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß**

```bash
python main_loader.py
```

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î:

* `all68_m3.parquet`
* `68_m3.parquet`

‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ `getCNPDF()` ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå PDF ‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ reqlist

---

# ‚öôÔ∏è **‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (CLI Options)**

| Option               | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢                                 |
| -------------------- | ---------------------------------------- |
| `--create`           | ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î parquet           |
| `--data-dir PATH`    | ‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (default: `data/`)    |
| `--parquet-all PATH` | ‡πÑ‡∏ü‡∏•‡πå parquet ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î         |
| `--parquet-m3 PATH`  | ‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô getData2Frame          |
| `--parquet-gpa PATH` | ‡πÑ‡∏ü‡∏•‡πå GPA (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)                         |
| `--threads`          | ‡πÄ‡∏õ‡∏¥‡∏î multi-thread ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô |
| `--progress`         | ‡πÅ‡∏™‡∏î‡∏á progress bar (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ tqdm)          |
| `--recursive`        | ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ã‡πâ‡∏≠‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå             |

---

# üñ• **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£**

## üü¶ Windows CMD/PowerShell

```powershell
python main_loader.py --create --threads --progress
```

## üü© Ubuntu / Debian / Linux

```bash
python3 main_loader.py --create --data-dir data --threads
```

## üü™ macOS

```bash
python3 main_loader.py --create --progress
```

---

# üìú **‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà**

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Output:

```
INFO: DataLoader: found 33 files matching ['*.xls', '*.xlsx', '*.csv']
INFO: Reading 1/33: data/score1.xls
INFO: OK rows=250
...
WARNING: Failed reading data/broken.xls: read_excel_failed
INFO: Combined rows: 16750
INFO: Saved parquet to all68_m3.parquet using fastparquet
INFO: Saved parquet to 68_m3.parquet using fastparquet
```

---

# üß™ **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**

‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

```python
import pandas as pd
df = pd.read_parquet("all68_m3.parquet", engine="fastparquet")
print(df.head())
```

---

# üóÇ **‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö PDF**

‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ `getCNPDF()`:

```python
m3 = [m3_student, gpa_m3]
```

‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å:

```python
getCNPDF(m3, 44132)
```

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

---

# üìå ‡∏™‡∏£‡∏∏‡∏õ

‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏ö Utility ‡∏ó‡∏µ‡πà:

* Robust
* Cross-platform
* Fastparquet-only
* ‡∏°‡∏µ fallback-handling
* ‡πÉ‡∏ä‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô CLI
* ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö PDF ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ

---


